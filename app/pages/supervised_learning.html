<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Supervised Learning - Python to AI</title>
	<meta name="description" content="Supervised Machine Learning projects: Crime Prediction and Census Income Classification.">

	<!-- Tailwind CSS -->
	<script src="https://cdn.tailwindcss.com"></script>

	<!-- FontAwesome -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">

	<!-- Highlight.js -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/python.min.js"></script>
	<script>hljs.highlightAll();</script>

	<!-- ONNX Runtime Web -->
	<script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.17.3/dist/ort.min.js"></script>

	<style type="text/tailwindcss">
		body {
            font-family: 'Nunito', sans-serif;
        }

        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-gray-50 transition-colors cursor-pointer;
        }

        .nav-link.active {
            @apply text-indigo-700 bg-indigo-50 font-bold;
        }

        /* Sidebar Styling */
        .sidebar-link {
            @apply block px-4 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-indigo-600 rounded-md transition-colors;
        }
        
        .sidebar-link.active {
            @apply bg-indigo-50 text-indigo-700 font-bold border-r-4 border-indigo-600;
        }

        .content-section {
            @apply scroll-mt-24 mb-16 border-b border-gray-100 pb-12;
        }

        h2 {
            @apply text-2xl font-bold text-gray-800 mb-4 flex items-center;
        }
        
        h3 {
             @apply text-xl font-semibold text-gray-700 mt-6 mb-3;
        }

        p {
            @apply text-gray-600 leading-relaxed mb-4;
        }

        code:not(.hljs) {
            @apply bg-gray-100 text-red-500 px-1 py-0.5 rounded text-sm font-mono;
        }
        
        pre {
            @apply rounded-lg shadow-sm overflow-hidden my-4 border border-gray-200;
        }

        .card {
            @apply bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden;
        }
    </style>
</head>

<body class="bg-gray-50 min-h-screen flex flex-col">

	<!-- NAVIGATION -->
	<nav class="bg-white shadow-sm sticky top-0 z-50">
		<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
			<div class="flex justify-between h-16">
				<div class="flex">
					<div class="flex-shrink-0 flex items-center">
						<a href="../../index.html" class="flex items-center">
							<i class="fa-solid fa-code fa-2x text-indigo-600"></i>
							<span class="ml-2 font-bold text-xl text-gray-800">Python to AI</span>
						</a>
					</div>
				</div>
				<div class="hidden md:flex items-center space-x-1">
					<a href="../../index.html" class="nav-link">Home</a>
					<a href="python.html" class="nav-link">Python Basics</a>
					<a href="ml_basics.html" class="nav-link">ML Basics</a>
					<a href="supervised_learning.html" class="nav-link active">Supervised ML</a>
					<a href="unsupervised_learning.html" class="nav-link">Unsupervised</a>
					<a href="deep_learning.html" class="nav-link">Deep Learning</a>
				</div>
				<div class="flex items-center">
					<a href="https://github.com/ikathuria" target="_blank" class="text-gray-400 hover:text-gray-600 mx-2"><i class="fa-brands fa-github fa-lg"></i></a>
				</div>
			</div>
		</div>
	</nav>

	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
		<div class="flex flex-col md:flex-row gap-8">

			<!-- LEFT SIDEBAR -->
			<aside class="md:w-64 flex-shrink-0">
				<div class="sticky top-24 bg-white rounded-xl shadow-sm border border-gray-100 p-4">
					<h3 class="text-xs font-bold text-gray-400 uppercase tracking-wider mb-3">Contents</h3>
					<nav class="space-y-1">
						<a href="#intro" class="sidebar-link active" onclick="setActive(this)">Overview</a>
						<a href="#naive-bayes" class="sidebar-link" onclick="setActive(this)">Naive Bayes</a>
						<a href="#knn" class="sidebar-link" onclick="setActive(this)">K-Nearest Neighbors</a>
						<a href="#neural-networks" class="sidebar-link" onclick="setActive(this)">Neural Networks</a>
					</nav>
				</div>
			</aside>

			<!-- MAIN CONTENT -->
			<main class="flex-grow min-w-0">

				<!-- Introduction -->
				<section id="intro" class="content-section">
					<h1 class="text-4xl font-extrabold text-gray-900 mb-6">Supervised Machine Learning</h1>
					<p class="text-lg text-gray-600 mb-4">
						In supervised learning, the model learns from labeled training data, making predictions based on known input-output pairs. This section explores several key algorithms with interactive demos running directly in your browser.
					</p>
				</section>

				<!-- Naive Bayes -->
				<section id="naive-bayes" class="content-section">
					<h2><i class="fa-solid fa-pills mr-3 text-indigo-500"></i> Naive Bayes</h2>
					<p>A probabilistic classifier based on Bayes' Theorem. In this example, we predict the appropriate drug for a patient based on their health metrics.</p>

					<div class="bg-gray-800 text-white p-6 rounded-xl shadow-lg relative overflow-hidden mb-6">
						<div class="absolute top-2 right-2 text-xs bg-green-500 text-white font-bold px-2 py-1 rounded">ONNX Enabled</div>
						<h3 class="text-2xl font-bold mb-2 text-white mt-0">Drug Classification</h3>
						<p class="opacity-80 mb-0">Predicts drug type (Y, C, X, A, B) based on patient vitals.</p>
					</div>

					<div class="card p-6">
						<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
							<div>
								<label class="block text-xs font-bold text-gray-500 mb-1">Age</label>
								<input type="number" id="drug-age" value="45" class="w-full border p-2 rounded focus:ring-indigo-500 focus:border-indigo-500">
							</div>
							<div>
								<label class="block text-xs font-bold text-gray-500 mb-1">Sex</label>
								<select id="drug-sex" class="w-full border p-2 rounded focus:ring-indigo-500 focus:border-indigo-500">
									<option value="0">Female</option>
									<option value="1">Male</option>
								</select>
							</div>
							<div>
								<label class="block text-xs font-bold text-gray-500 mb-1">Blood Pressure</label>
								<select id="drug-bp" class="w-full border p-2 rounded focus:ring-indigo-500 focus:border-indigo-500">
									<option value="0">HIGH</option>
									<option value="1">LOW</option>
									<option value="2">NORMAL</option>
								</select>
							</div>
							<div>
								<label class="block text-xs font-bold text-gray-500 mb-1">Cholesterol</label>
								<select id="drug-cholestrol" class="w-full border p-2 rounded focus:ring-indigo-500 focus:border-indigo-500">
									<option value="0">HIGH</option>
									<option value="1">NORMAL</option>
								</select>
							</div>
							<div>
								<label class="block text-xs font-bold text-gray-500 mb-1">Na_to_K Ratio</label>
								<input type="number" id="drug-na_to_k" value="15.5" step="0.1" class="w-full border p-2 rounded focus:ring-indigo-500 focus:border-indigo-500">
							</div>
						</div>

						<button onclick="runDrugPrediction()" class="mt-6 w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3 rounded transition shadow-md">
							Predict Drug
						</button>

						<div id="drug-result" class="mt-4 p-4 bg-gray-100 rounded text-center text-xl hidden border border-gray-200"></div>
					</div>
				</section>

				<!-- KNN -->
				<section id="knn" class="content-section">
					<h2><i class="fa-solid fa-network-wired mr-3 text-indigo-500"></i> K-Nearest Neighbors</h2>
					<p>KNN is a simple, versatile algorithm that stores all available cases and classifies new cases based on a similarity measure (e.g., distance functions).</p>
					<pre><code class="language-python">from sklearn.neighbors import KNeighborsClassifier
knn = KNeighborsClassifier(n_neighbors=3)
knn.fit(X_train, y_train)
y_pred = knn.predict(X_test)</code></pre>
				</section>

				<!-- Neural Networks (Crime) -->
				<section id="neural-networks" class="content-section">
					<h2><i class="fa-solid fa-brain mr-3 text-indigo-500"></i> Artificial Neural Networks</h2>
					<p>Neural networks are a set of algorithms, modeled loosely after the human brain, that are designed to recognize patterns.</p>

					<div class="bg-indigo-600 text-white p-6 rounded-xl shadow-lg mb-6">
						<div class="flex items-center justify-between">
							<h3 class="text-2xl font-bold mb-2 text-white mt-0">Chicago Crime Predictor</h3>
							<span class="bg-white text-indigo-600 text-xs px-2 py-1 rounded uppercase font-bold">Live Demo</span>
						</div>
						<p class="opacity-90 mb-0">Forecasts crime counts or predicts arrests using an MLP (Multi-Layer Perceptron).</p>
					</div>

					<div class="card p-6">
						<!-- Model Controls -->
						<div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
							<div>
								<label for="predictionTypeSelector" class="block text-sm font-semibold text-gray-700 mb-2">1. Prediction Task</label>
								<select id="predictionTypeSelector" onchange="updatePredictionType()" class="block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-indigo-500 focus:border-indigo-500">
									<option value="CLASSIFICATION">Binary Classification (Predict Arrest)</option>
									<option value="REGRESSION">Regression (Forecast Crime Count)</option>
								</select>
							</div>
							<div>
								<label for="modelSelector" class="block text-sm font-semibold text-gray-700 mb-2">2. Model Architecture</label>
								<select id="modelSelector" onchange="loadModel()" class="block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-indigo-500 focus:border-indigo-500">
								</select>
							</div>
						</div>

						<!-- Inputs -->
						<h4 class="text-sm font-bold text-gray-500 uppercase tracking-wide mb-3">Features</h4>
						<div id="inputFormContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
							<!-- Dynamic Inputs -->
						</div>

						<!-- Button -->
						<button onclick="runPrediction()" id="predictBtn" class="w-full mt-6 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition transform hover:scale-[1.01] shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
							Loading Model...
						</button>

						<!-- Output -->
						<div id="output" class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg hidden">
							<h4 class="text-lg font-bold text-green-800">Prediction Result</h4>
							<div id="resultText" class="text-xl mt-1"></div>
							<div id="confidence" class="text-sm text-gray-600 mt-1"></div>
						</div>
						<div id="loading" class="mt-6 p-4 bg-blue-50 text-blue-800 rounded-lg hidden animate-pulse">
							Processing...
						</div>
					</div>
				</section>

			</main>
		</div>
	</div>

	<!-- JAVASCRIPT LOGIC (Unchanged functionality, just adapting to new layout) -->
	<script>
		function setActive(element) {
			document.querySelectorAll('.sidebar-link').forEach(el => el.classList.remove('active'));
			element.classList.add('active');
		}

		// --- CRIME PREDICTION MODEL LOGIC ---
		const NORM_CONSTANTS = {
			CLASSIFICATION: {
				INPUT_DIM: 15,
				X_MEANS: new Float32Array([18435, 14.835, 115.36, 0.1966, 1148.9, 11.260, 23.228, 36.587, 11.047, 2021.0, 41.844, -87.670, 12.932, 2.972, 6.619]),
				X_DEVIATIONS: new Float32Array([11375, 12.067, 59.395, 0.39753, 702.12, 7.016, 13.978, 21.535, 5.8643, 2.0642, 0.0879, 0.0592, 6.0050, 2.0050, 3.3636]),
			},
			REGRESSION: {
				INPUT_DIM: 55,
				X_MEANS: new Float32Array([2.9716, 6.6190, 2021.0, 41.844, -87.670, ...new Array(50).fill(0).map((_, i) => i < 5 ? [0.0179, 0.0187, 0.0280, 0.0267, 0.0243][i] : 0)]),
				X_DEVIATIONS: new Float32Array([2.0050, 3.3636, 2.0609, 0.0879, 0.0592, ...new Array(50).fill(1).map((_, i) => i < 5 ? [0.1329, 0.1357, 0.1653, 0.1614, 0.1543][i] : 1)]),
			}
		};

		const MODEL_OPTIONS = {
			CLASSIFICATION: [
				{ value: "../onnx_models/MLP_Model_Classification.onnx", text: "MLP Model (Shallow)" },
				{ value: "../onnx_models/DL_Model_Classification.onnx", text: "DL Model (Deep Learning)" }
			],
			REGRESSION: [
				{ value: "../onnx_models/linreg_model_Regression.onnx", text: "LinRegNet Model" },
				{ value: "../onnx_models/mlp_model_Regression.onnx", text: "MLPNet Model" },
				{ value: "../onnx_models/dl_model_Regression.onnx", text: "DLNet Model" },
				{ value: "../onnx_models/mix_model_Regression.onnx", text: "Linear+NonLinear Model" }
			]
		};

		const CLASSIFICATION_FEATURES = [
			{ id: 'block', name: 'Block (Code)', type: 'number', default: 18435 },
			{ id: 'primaryType', name: 'Primary Type (Code)', type: 'number', default: 14 },
			{ id: 'locationDesc', name: 'Location Desc. (Code)', type: 'number', default: 17 },
			{ id: 'domestic', name: 'Domestic (0/1)', type: 'number', default: 0, min: 0, max: 1 },
			{ id: 'beat', name: 'Beat', type: 'number', default: 1148 },
			{ id: 'district', name: 'District', type: 'number', default: 11 },
			{ id: 'ward', name: 'Ward', type: 'number', default: 23 },
			{ id: 'communityArea', name: 'Community Area', type: 'number', default: 36 },
			{ id: 'fbiCode', name: 'FBI Code (Code)', type: 'number', default: 10 },
			{ id: 'year', name: 'Year', type: 'number', default: 2025 },
			{ id: 'latitude', name: 'Latitude', type: 'number', default: 41.8787, step: 'any' },
			{ id: 'longitude', name: 'Longitude', type: 'number', default: -87.6508, step: 'any' },
			{ id: 'hour', name: 'Hour', type: 'number', default: 0, min: 0, max: 23 },
			{ id: 'day', name: 'Day (Code 0-6)', type: 'number', default: 6, min: 0, max: 6 },
			{ id: 'month', name: 'Month', type: 'number', default: 1, min: 1, max: 12 },
		];

		const REGRESSION_CORE_FEATURES = [
			{ id: 'day', name: 'Day (Code 0-6)', type: 'number', default: 6, min: 0, max: 6 },
			{ id: 'month', name: 'Month', type: 'number', default: 1, min: 1, max: 12 },
			{ id: 'year', name: 'Year', type: 'number', default: 2025 },
			{ id: 'latitude', name: 'Latitude', type: 'number', default: 41.8787, step: 'any' },
			{ id: 'longitude', name: 'Longitude', type: 'number', default: -87.6508, step: 'any' },
			{ id: 'ward', name: 'Ward (1-50)', type: 'number', default: 23, min: 1, max: 50 },
		];

		let session = null;
		let isModelLoaded = false;
		let currentTask = 'CLASSIFICATION';

		function updatePredictionType() {
			const typeSelector = document.getElementById('predictionTypeSelector');
			const modelSelector = document.getElementById('modelSelector');
			currentTask = typeSelector.value;

			// Update Models
			const models = MODEL_OPTIONS[currentTask];
			modelSelector.innerHTML = models.map(m => `<option value="${m.value}">${m.text}</option>`).join('');

			// Update Inputs
			updateInputForm();

			loadModel();
		}

		function updateInputForm() {
			const features = currentTask === 'CLASSIFICATION' ? CLASSIFICATION_FEATURES : REGRESSION_CORE_FEATURES;
			const container = document.getElementById('inputFormContainer');

			let html = '';
			features.forEach(f => {
				html += `
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">${f.name}</label>
                        <input type="${f.type}" id="${f.id}" value="${f.default}" 
                            ${f.step ? `step="${f.step}"` : ''}
                            ${f.min !== undefined ? `min="${f.min}"` : ''}
                            ${f.max !== undefined ? `max="${f.max}"` : ''}
                            class="block w-full rounded-md border-gray-300 shadow-sm p-2 text-sm border focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                `;
			});
			container.innerHTML = html;
		}

		async function loadModel() {
			const modelSelector = document.getElementById('modelSelector');
			const predictBtn = document.getElementById('predictBtn');
			const loadingDiv = document.getElementById('loading');
			const outputDiv = document.getElementById('output');

			let modelPath = modelSelector.value;
			// Clean path just in case
			if (modelPath.startsWith('app/')) {
				modelPath = '../' + modelPath.substring(4);
			}

			isModelLoaded = false;
			predictBtn.disabled = true;
			loadingDiv.classList.remove('hidden');
			loadingDiv.innerHTML = `Loading model...`;
			outputDiv.classList.add('hidden');

			try {
				if (session) { session.release(); session = null; }
				session = await ort.InferenceSession.create(modelPath);
				isModelLoaded = true;
				predictBtn.disabled = false;
				predictBtn.textContent = `Run Prediction`;
				loadingDiv.classList.add('hidden');
			} catch (e) {
				loadingDiv.innerHTML = `<span class="text-red-700 font-bold">Error:</span> ${e.message}. <br>Path: ${modelPath}`;
				loadingDiv.classList.remove('hidden');
				console.error("Model Load Error:", e);
			}
		}

		async function runPrediction() {
			if (!isModelLoaded) { await loadModel(); return; }

			const loadingDiv = document.getElementById('loading');
			const outputDiv = document.getElementById('output');

			outputDiv.classList.add('hidden');
			loadingDiv.classList.remove('hidden');
			loadingDiv.textContent = "Predicting...";

			try {
				const rawInputTensor = getRawInput();
				const processedInput = preprocess(rawInputTensor);
				const { INPUT_DIM } = NORM_CONSTANTS[currentTask];

				const inputTensor = new ort.Tensor('float32', processedInput, [1, INPUT_DIM]);
				const results = await session.run({ input1: inputTensor });
				const outputData = results.output1.data;

				displayResult(outputData);
			} catch (e) {
				loadingDiv.innerHTML = `<span class="text-red-600">Inference Error:</span> ${e.message}`;
			}
		}

		function getRawInput() {
			const featureDefs = currentTask === 'CLASSIFICATION' ? CLASSIFICATION_FEATURES : REGRESSION_CORE_FEATURES;
			const rawInputs = {};
			featureDefs.forEach(f => rawInputs[f.id] = parseFloat(document.getElementById(f.id).value));

			if (currentTask === 'CLASSIFICATION') {
				return new Float32Array([
					rawInputs.block, rawInputs.primaryType, rawInputs.locationDesc, rawInputs.domestic, rawInputs.beat,
					rawInputs.district, rawInputs.ward, rawInputs.communityArea, rawInputs.fbiCode, rawInputs.year,
					rawInputs.latitude, rawInputs.longitude, rawInputs.hour, rawInputs.day, rawInputs.month
				]);
			} else {
				const fullInput = new Float32Array(55).fill(0);
				fullInput[0] = rawInputs.day; fullInput[1] = rawInputs.month; fullInput[2] = rawInputs.year;
				fullInput[3] = rawInputs.latitude; fullInput[4] = rawInputs.longitude;
				const wardIndex = rawInputs.ward;
				if (wardIndex >= 1 && wardIndex <= 50) fullInput[4 + wardIndex] = 1.0;
				return fullInput;
			}
		}

		function preprocess(raw) {
			const { INPUT_DIM, X_MEANS, X_DEVIATIONS } = NORM_CONSTANTS[currentTask];
			const processed = new Float32Array(INPUT_DIM);
			for (let i = 0; i < INPUT_DIM; i++) processed[i] = (raw[i] - X_MEANS[i]) / X_DEVIATIONS[i];
			return processed;
		}

		function displayResult(outputData) {
			const loadingDiv = document.getElementById('loading');
			const outputDiv = document.getElementById('output');
			const resultText = document.getElementById('resultText');
			const confidenceDiv = document.getElementById('confidence');

			loadingDiv.classList.add('hidden');
			outputDiv.classList.remove('hidden');

			if (currentTask === 'CLASSIFICATION') {
				const [probNo, probYes] = outputData;
				const isArrest = probYes > probNo;
				resultText.innerHTML = isArrest
					? `<span class="text-red-600"><i class="fa-solid fa-handcuffs"></i> Arrest Likely</span>`
					: `<span class="text-green-600"><i class="fa-regular fa-face-smile"></i> Arrest Unlikely</span>`;
				confidenceDiv.textContent = `Probability: ${(probYes * 100).toFixed(1)}%`;
			} else {
				resultText.innerHTML = `<span class="text-indigo-600">${Math.round(outputData[0])} Crimes</span>`;
				confidenceDiv.textContent = `Raw value: ${outputData[0].toFixed(2)}`;
			}
		}

		// --- DRUG PREDICTION MODEL LOGIC ---
		async function runDrugPrediction() {
			const resultDiv = document.getElementById('drug-result');
			resultDiv.classList.add('hidden');

			// 1. Gather Inputs
			const age = parseFloat(document.getElementById('drug-age').value);
			const sex = parseFloat(document.getElementById('drug-sex').value); // 0 or 1
			const bp = parseFloat(document.getElementById('drug-bp').value); // 0, 1, 2
			const cholesterol = parseFloat(document.getElementById('drug-cholestrol').value); // 0, 1
			const na_to_k = parseFloat(document.getElementById('drug-na_to_k').value);

			const inputData = new Float32Array([age, sex, bp, cholesterol, na_to_k]);

			try {
				// 2. Load Model
				const session = await ort.InferenceSession.create('../onnx_models/naive_bayes.onnx');

				// DEBUG: Check input/output names
				console.log("Model Input Names:", session.inputNames);
				console.log("Model Output Names:", session.outputNames);

				const inputName = session.inputNames[0];
				const outputName = session.outputNames[0];

				// 3. Run Inference
				const tensor = new ort.Tensor('float32', inputData, [1, 5]);

				// Create feeds object dynamically
				const feeds = {};
				feeds[inputName] = tensor;

				const results = await session.run(feeds, [outputName]);

				// 4. Process Output
				const labelIndex = Number(results[outputName].data[0]);

				// Map index to label
				// 0=DrugY, 1=drugC, 2=drugX, 3=drugA, 4=drugB
				const drugLabels = ["DrugY", "DrugC", "DrugX", "DrugA", "DrugB"];
				const drugName = drugLabels[labelIndex] || "Unknown";

				const colors = {
					"DrugY": "text-purple-600",
					"DrugC": "text-red-600",
					"DrugX": "text-blue-600",
					"DrugA": "text-green-600",
					"DrugB": "text-yellow-600"
				};
				const colorClass = colors[drugName] || "text-gray-800";

				resultDiv.innerHTML = `Recommended Drug: <span class="font-bold ${colorClass}">${drugName}</span>`;
				resultDiv.classList.remove('hidden');

			} catch (e) {
				console.error(e);
				resultDiv.innerHTML = `<span class="text-red-600">Error: ${e.message}</span>`;
				resultDiv.classList.remove('hidden');
			}
		}

		// Initialize
		document.addEventListener('DOMContentLoaded', () => {
			if (typeof ort === 'undefined') {
				console.error("ONNX Runtime not loaded");
				return;
			}
			// Disable multi-threading to avoid Cross-Origin Isolation warnings on simple servers
			ort.env.wasm.numThreads = 1;

			updatePredictionType();
		});

	</script>
</body>

</html>