<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Python to AI - Portfolio</title>
    <meta name="description" content="A comprehensive portfolio showcasing Python to AI projects ranging from Machine Learning to Deep Learning.">
    <meta name="author" content="Ishani Kathuria">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- FontAwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <!-- ONNX Runtime Web -->
    <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.17.3/dist/ort.min.js"></script>

    <style>
        body { font-family: 'Nunito', sans-serif; }
        .nav-link { @apply px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-gray-50 transition-colors cursor-pointer; }
        .nav-link.active { @apply text-indigo-700 bg-indigo-50 font-bold; }
        .section-container { @apply max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12; }
        .card { @apply bg-white rounded-xl shadow-md border border-gray-100 overflow-hidden; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col">

    <!-- NAVIGATION -->
    <nav class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fa-solid fa-code fa-2x text-indigo-600"></i>
                        <span class="ml-2 font-bold text-xl text-gray-800">Python to AI</span>
                    </div>
                    <div class="hidden sm:ml-6 sm:flex sm:space-x-4 items-center">
                        <a onclick="showSection('home')" id="nav-home" class="nav-link active">Home</a>
                        <a onclick="showSection('supervised')" id="nav-supervised" class="nav-link">Supervised ML</a>
                        <a onclick="showSection('unsupervised')" id="nav-unsupervised" class="nav-link">Unsupervised ML</a>
                        <a onclick="showSection('deeplearning')" id="nav-deeplearning" class="nav-link">Deep Learning</a>
                    </div>
                </div>
                <div class="flex items-center">
                    <a href="https://github.com/ikathuria" target="_blank" class="text-gray-400 hover:text-gray-600 mx-2"><i class="fa-brands fa-github fa-lg"></i></a>
                    <a href="https://linkedin.com/in/ishani-kathuria/" target="_blank" class="text-gray-400 hover:text-blue-600 mx-2"><i class="fa-brands fa-linkedin fa-lg"></i></a>
                    <a href="https://medium.com/@ishani-kathuria" target="_blank" class="text-gray-400 hover:text-black mx-2"><i class="fa-brands fa-medium fa-lg"></i></a>
                </div>
            </div>
        </div>
        <!-- Mobile Menu (Simple) -->
        <div class="sm:hidden border-t border-gray-200 bg-gray-50">
            <div class="flex flex-col space-y-1 px-4 py-2">
                <a onclick="showSection('home')" class="block py-2 text-base font-medium text-gray-700 hover:text-indigo-600">Home</a>
                <a onclick="showSection('supervised')" class="block py-2 text-base font-medium text-gray-700 hover:text-indigo-600">Supervised</a>
                <a onclick="showSection('unsupervised')" class="block py-2 text-base font-medium text-gray-700 hover:text-indigo-600">Unsupervised</a>
                <a onclick="showSection('deeplearning')" class="block py-2 text-base font-medium text-gray-700 hover:text-indigo-600">Deep Learning</a>
            </div>
        </div>
    </nav>

    <!-- CONTENT SECTIONS -->
    <main class="flex-grow">
        
        <!-- === HOME SECTION === -->
        <section id="home-section" class="section-container">
            <div class="text-center py-16">
                <h1 class="text-5xl font-extrabold text-gray-900 tracking-tight mb-4">
                    From Python to <span class="text-indigo-600">Artificial Intelligence</span>
                </h1>
                <p class="text-xl text-gray-500 max-w-2xl mx-auto mb-8">
                    A portfolio of Machine Learning and Deep Learning projects, demonstrating the journey from data processing to model deployment.
                </p>
                <div class="flex justify-center space-x-4">
                    <button onclick="showSection('supervised')" class="px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-indigo-600 hover:bg-indigo-700 md:text-lg">
                        Explore Demos
                    </button>
                    <a href="https://github.com/ikathuria/python-to-ai" target="_blank" class="px-6 py-3 border border-gray-300 text-base font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 md:text-lg">
                        View Code
                    </a>
                </div>
            </div>

            <!-- About Card -->
            <div class="max-w-3xl mx-auto card p-8 text-center bg-gradient-to-br from-indigo-50 to-white border-none shadow-lg">
                <div class="mb-4">
                    <img src="https://avatars.githubusercontent.com/u/57997976?v=4" alt="Ishani Kathuria" class="h-24 w-24 rounded-full mx-auto border-4 border-white shadow-sm">
                </div>
                <h2 class="text-2xl font-bold text-gray-800">Ishani Kathuria</h2>
                <p class="text-gray-600 mt-2">Data Science Enthusiast | AI Developer</p>
                <div class="mt-6 flex justify-center space-x-6">
                    <a href="https://linkedin.com/in/ishani-kathuria/" target="_blank" class="flex items-center text-gray-600 hover:text-blue-700 transition">
                        <i class="fa-brands fa-linkedin text-2xl mr-2"></i> LinkedIn
                    </a>
                    <a href="https://github.com/ikathuria/" target="_blank" class="flex items-center text-gray-600 hover:text-gray-900 transition">
                        <i class="fa-brands fa-github text-2xl mr-2"></i> GitHub
                    </a>
                </div>
            </div>
        </section>


        <!-- === SUPERVISED ML SECTION === -->
        <section id="supervised-section" class="section-container hidden">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 pb-2 border-b">Supervised Machine Learning</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-12 gap-8">
                <!-- Sidebar: Project Selector -->
                <div class="md:col-span-3 space-y-2">
                    <button onclick="showSupervisedProject('crime')" id="btn-crime" class="w-full text-left px-4 py-3 rounded-lg bg-indigo-50 text-indigo-700 font-semibold border-l-4 border-indigo-600 shadow-sm transition-all hover:bg-indigo-100">
                        <i class="fa-solid fa-gavel mr-2"></i> Crime Prediction
                    </button>
                    <button onclick="showSupervisedProject('census')" id="btn-census" class="w-full text-left px-4 py-3 rounded-lg text-gray-600 hover:bg-gray-50 hover:text-gray-900 border-l-4 border-transparent transition-all">
                        <i class="fa-solid fa-users mr-2"></i> Census Income
                    </button>
                    <div class="pt-4 text-xs text-gray-400 uppercase tracking-widest font-semibold">Algorithms</div>
                    <ul class="space-y-1 text-sm text-gray-500 pl-4">
                        <li>Naive Bayes</li>
                        <li>K-Nearest Neighbors</li>
                        <li>Logistic Regression</li>
                        <li>Decision Trees</li>
                    </ul>
                </div>

                <!-- Main Content Area -->
                <div class="md:col-span-9">
                    
                    <!-- CRIME PREDICTION MODEL (Interactive) -->
                    <div id="project-crime" class="space-y-6">
                        <div class="bg-indigo-600 text-white p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold mb-2">Chicago Crime Predictor <span class="bg-white text-indigo-600 text-xs px-2 py-1 rounded ml-2 uppercase">Live ONNX Demo</span></h3>
                            <p class="opacity-90">Predicts prediction of an arrest or forecasts crime counts based on location and time data using a trained Neural Network (MLP) deployed in the browser.</p>
                        </div>
                        
                        <!-- ORIGINAL INPUT FORM INTEGRATION -->
                        <div class="card p-6 sm:p-8">
                            <!-- Model Controls -->
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6 p-4 bg-gray-50 rounded-lg">
                                <div>
                                    <label for="predictionTypeSelector" class="block text-sm font-semibold text-gray-700 mb-2">1. Prediction Task</label>
                                    <select id="predictionTypeSelector" onchange="updatePredictionType()" class="block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-indigo-500 focus:border-indigo-500">
                                        <option value="CLASSIFICATION">Binary Classification (Predict Arrest)</option>
                                        <option value="REGRESSION">Regression (Forecast Crime Count)</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="modelSelector" class="block text-sm font-semibold text-gray-700 mb-2">2. Model Architecture</label>
                                    <select id="modelSelector" onchange="loadModel()" class="block w-full rounded-md border-gray-300 shadow-sm p-2 border focus:ring-indigo-500 focus:border-indigo-500">
                                        <!-- Populated via JS -->
                                    </select>
                                </div>
                            </div>

                             <!-- Inputs -->
                            <h4 class="text-lg font-semibold text-gray-800 mb-3">3. Features</h4>
                            <div id="inputFormContainer" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4">
                                <!-- Dynamic Inputs -->
                            </div>

                            <!-- Button -->
                            <button onclick="runPrediction()" id="predictBtn" class="w-full mt-6 bg-indigo-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-indigo-700 transition transform hover:scale-[1.01] shadow-md disabled:opacity-50 disabled:cursor-not-allowed">
                                Loading Model...
                            </button>

                             <!-- Output -->
                            <div id="output" class="mt-6 p-4 bg-green-50 border border-green-200 rounded-lg hidden">
                                <h4 class="text-lg font-bold text-green-800">Prediction Result</h4>
                                <div id="resultText" class="text-xl mt-1"></div>
                                <div id="confidence" class="text-sm text-gray-600 mt-1"></div>
                            </div>
                            <div id="loading" class="mt-6 p-4 bg-blue-50 text-blue-800 rounded-lg hidden animate-pulse">
                                Processing...
                            </div>
                        </div>
                    </div>

                    <!-- CENSUS INCOME PREDICTION (Static UI) -->
                    <div id="project-census" class="space-y-6 hidden">
                        <div class="bg-gray-800 text-white p-6 rounded-xl shadow-lg relative overflow-hidden">
                             <div class="absolute top-2 right-2 text-xs bg-yellow-500 text-black font-bold px-2 py-1 rounded">Backend Required</div>
                            <h3 class="text-2xl font-bold mb-2">Census Income Prediction</h3>
                            <p class="opacity-80">Classifies whether income exceeds $50K/yr based on census data. (UI Demo Only - Requires Flask Backend)</p>
                        </div>

                        <div class="card p-6 pointer-events-none opacity-75 grayscale-[0.3]">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Age</label>
                                    <input type="number" value="39" class="mt-1 block w-full border-gray-300 rounded-md shadow-sm border p-2">
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Workclass</label>
                                    <select class="mt-1 block w-full border-gray-300 rounded-md shadow-sm border p-2">
                                        <option>State-gov</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Education</label>
                                    <select class="mt-1 block w-full border-gray-300 rounded-md shadow-sm border p-2">
                                        <option>Bachelors</option>
                                    </select>
                                </div>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700">Marital Status</label>
                                    <select class="mt-1 block w-full border-gray-300 rounded-md shadow-sm border p-2">
                                        <option>Never-married</option>
                                    </select>
                                </div>
                            </div>
                            <button class="mt-6 w-full bg-gray-500 text-white py-2 rounded cursor-not-allowed">Submit (Backend Unavailable)</button>
                        </div>
                    </div>

                </div>
            </div>
        </section>


        <!-- === UNSUPERVISED ML SECTION === -->
        <section id="unsupervised-section" class="section-container hidden">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 pb-2 border-b">Unsupervised Machine Learning</h2>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <!-- Clustering Card -->
                <div class="card p-6 hover:shadow-lg transition">
                    <div class="flex items-center justify-between mb-4">
                        <div class="bg-purple-100 p-3 rounded-full text-purple-600"><i class="fa-solid fa-shapes fa-xl"></i></div>
                        <span class="text-xs font-bold bg-yellow-100 text-yellow-800 px-2 py-1 rounded">BACKEND</span>
                    </div>
                    <h3 class="text-xl font-bold mb-2">K-Means Clustering</h3>
                    <p class="text-gray-600 text-sm mb-4">Groups Iris flower data based on petal length and width.</p>
                    
                     <!-- Mock UI -->
                    <div class="space-y-3 p-4 bg-gray-50 rounded border border-gray-200">
                        <div>
                            <label class="text-xs font-bold text-gray-500">Petal Length (cm)</label>
                            <input type="range" class="w-full accent-purple-600" value="1.4">
                        </div>
                        <div>
                            <label class="text-xs font-bold text-gray-500">Petal Width (cm)</label>
                            <input type="range" class="w-full accent-purple-600" value="0.2">
                        </div>
                        <button class="w-full text-xs bg-purple-600 text-white py-2 rounded opacity-50 cursor-not-allowed">Cluster Data</button>
                    </div>
                </div>

                <!-- Theory Cards -->
                <div class="card p-6 border-l-4 border-l-blue-500">
                    <h3 class="text-lg font-bold mb-2">Hidden Markov Models</h3>
                    <p class="text-gray-600 text-sm">Statistical Markov model with unobserved (hidden) states. Used for temporal pattern recognition.</p>
                </div>
                 <div class="card p-6 border-l-4 border-l-green-500">
                    <h3 class="text-lg font-bold mb-2">PCA</h3>
                    <p class="text-gray-600 text-sm">Principal Component Analysis. Dimensionality reduction technique to simplify complex data sets.</p>
                </div>
            </div>
        </section>


         <!-- === DEEP LEARNING SECTION === -->
         <section id="deeplearning-section" class="section-container hidden">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 pb-2 border-b">Deep Learning</h2>

            <div class="space-y-12">
                
                <!-- GPT-3 Project -->
                <div class="card flex flex-col md:flex-row overflow-hidden">
                    <div class="md:w-1/3 bg-gradient-to-br from-green-400 to-blue-500 p-8 text-white flex flex-col justify-center">
                        <i class="fa-solid fa-robot fa-3x mb-4"></i>
                        <h3 class="text-2xl font-bold mb-2">GPT-3 Content Gen</h3>
                        <p class="opacity-90 text-sm">Generates blog articles using OpenAI's GPT-3 API. Give it a topic, and it writes for you.</p>
                        <span class="mt-4 inline-block bg-black bg-opacity-20 text-xs px-2 py-1 rounded w-max">Requires OpenAI API Key</span>
                    </div>
                    <div class="md:w-2/3 p-8">
                        <h4 class="font-bold text-gray-800 mb-4">Demo Interface</h4>
                        <div class="flex space-x-2">
                            <input type="text" placeholder="Enter blog topic (e.g. 'Future of AI')" class="flex-grow border border-gray-300 rounded-md shadow-sm p-3 focus:ring-blue-500 focus:border-blue-500" disabled>
                            <button class="bg-blue-600 text-white px-6 rounded-md font-medium opacity-50 cursor-not-allowed">Generate</button>
                        </div>
                        <div class="mt-4 p-4 bg-gray-50 rounded border border-gray-100 h-32 flex items-center justify-center text-gray-400 italic">
                            Generated content appears here...
                        </div>
                    </div>
                </div>

                <!-- Hand Gesture Project -->
                <div class="card bg-gray-900 text-white overflow-hidden">
                    <div class="p-8 pb-0">
                         <div class="flex justify-between items-start">
                            <div>
                                <h3 class="text-2xl font-bold mb-2">Hand Gesture Recognition</h3>
                                <p class="text-gray-400 max-w-2xl">Real-time computer vision using OpenCV and MediaPipe. Detects hand landmarks and classifies gestures.</p>
                            </div>
                            <span class="bg-red-600 text-xs font-bold px-2 py-1 rounded">CV Backend Required</span>
                        </div>
                    </div>
                    
                    <!-- Gallery -->
                    <div class="p-8">
                        <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-6 gap-4">
                            <!-- Helper to generate gallery items -->
                            <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/zero/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">Zero</span>
                            </div>
                            <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/one/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">One</span>
                            </div>
                             <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/two/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">Two</span>
                            </div>
                             <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/ok/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">Ok</span>
                            </div>
                             <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/up/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">Up</span>
                            </div>
                             <div class="text-center">
                                <div class="aspect-square bg-gray-800 rounded-lg mb-2 overflow-hidden border border-gray-700"><img src="https://raw.githubusercontent.com/ikathuria/GestureRecognition/e1ab1d0a03aece880f7e45b8015d9beb200e87db/data/down/0.jpg" class="w-full h-full object-cover opacity-80"></div>
                                <span class="text-sm font-mono text-gray-400">Down</span>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
         </section>

    </main>

    <!-- FOOTER -->
    <footer class="bg-gray-800 text-white py-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 text-center">
            <p class="mb-4">Designed & Built by Ishani Kathuria</p>
            <div class="flex justify-center space-x-6 text-2xl">
                <a href="https://github.com/ikathuria" class="hover:text-indigo-400 transition"><i class="fa-brands fa-github"></i></a>
                <a href="https://linkedin.com/in/ishani-kathuria/" class="hover:text-blue-400 transition"><i class="fa-brands fa-linkedin"></i></a>
            </div>
            <p class="text-gray-500 text-sm mt-4">&copy; 2025 Python to AI.</p>
        </div>
    </footer>


    <!-- JAVASCRIPT LOGIC -->
    <script>
        // --- NAVIGATION LOGIC ---
        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('section.section-container').forEach(el => el.classList.add('hidden'));
            // Remove active state from navs
            document.querySelectorAll('.nav-link').forEach(el => el.classList.remove('active', 'text-indigo-700', 'bg-indigo-50', 'font-bold'));
            
            // Show selected
            document.getElementById(`${sectionId}-section`).classList.remove('hidden');
            // Highlight nav
            const navItem = document.getElementById(`nav-${sectionId}`);
            if(navItem) navItem.classList.add('active', 'text-indigo-700', 'bg-indigo-50', 'font-bold');
        }

        function showSupervisedProject(projectId) {
            // Toggle sidebar buttons
            document.getElementById('btn-crime').classList.remove('bg-indigo-50', 'text-indigo-700', 'font-semibold', 'border-indigo-600', 'shadow-sm');
            document.getElementById('btn-crime').classList.add('text-gray-600', 'border-transparent');
            
            document.getElementById('btn-census').classList.remove('bg-indigo-50', 'text-indigo-700', 'font-semibold', 'border-indigo-600', 'shadow-sm');
            document.getElementById('btn-census').classList.add('text-gray-600', 'border-transparent');

            // Apply style to active
            const activeBtn = document.getElementById(`btn-${projectId}`);
            activeBtn.classList.add('bg-indigo-50', 'text-indigo-700', 'font-semibold', 'border-indigo-600', 'shadow-sm');
            activeBtn.classList.remove('text-gray-600', 'border-transparent');

            // Toggle Content
            document.getElementById('project-crime').classList.add('hidden');
            document.getElementById('project-census').classList.add('hidden');
            document.getElementById(`project-${projectId}`).classList.remove('hidden');
        }


        // --- CRIME PREDICTION MODEL LOGIC (Ported from original index.html) ---
        
        // Constants (from original file)
        const NORM_CONSTANTS = {
            CLASSIFICATION: {
                INPUT_DIM: 15,
                X_MEANS: new Float32Array([18435, 14.835, 115.36, 0.1966, 1148.9, 11.260, 23.228, 36.587, 11.047, 2021.0, 41.844, -87.670, 12.932, 2.972, 6.619]),
                X_DEVIATIONS: new Float32Array([11375, 12.067, 59.395, 0.39753, 702.12, 7.016, 13.978, 21.535, 5.8643, 2.0642, 0.0879, 0.0592, 6.0050, 2.0050, 3.3636]),
            },
            REGRESSION: {
                INPUT_DIM: 55,
                X_MEANS: new Float32Array([2.9716, 6.6190, 2021.0, 41.844, -87.670, ...new Array(50).fill(0).map((_,i) => i < 5 ? [0.0179, 0.0187, 0.0280, 0.0267, 0.0243][i] : 0)]),
                X_DEVIATIONS: new Float32Array([2.0050, 3.3636, 2.0609, 0.0879, 0.0592, ...new Array(50).fill(1).map((_,i) => i < 5 ? [0.1329, 0.1357, 0.1653, 0.1614, 0.1543][i] : 1)]),
            }
        };

        const MODEL_OPTIONS = {
            CLASSIFICATION: [
                { value: "app/deployment/onnx_models/MLP_Model_Classification.onnx", text: "MLP Model (Shallow)" },
                { value: "app/deployment/onnx_models/DL_Model_Classification.onnx", text: "DL Model (Deep Learning)" }
            ],
            REGRESSION: [
                { value: "app/deployment/onnx_models/linreg_model_Regression.onnx", text: "LinRegNet Model" },
                { value: "app/deployment/onnx_models/mlp_model_Regression.onnx", text: "MLPNet Model" },
                { value: "app/deployment/onnx_models/dl_model_Regression.onnx", text: "DLNet Model" },
                { value: "app/deployment/onnx_models/mix_model_Regression.onnx", text: "Linear+NonLinear Model" }
            ]
        };
        
        const CLASSIFICATION_FEATURES = [
            { id: 'block', name: 'Block (Code)', type: 'number', default: 18435 },
            { id: 'primaryType', name: 'Primary Type (Code)', type: 'number', default: 14 },
            { id: 'locationDesc', name: 'Location Desc. (Code)', type: 'number', default: 17 },
            { id: 'domestic', name: 'Domestic (0/1)', type: 'number', default: 0, min: 0, max: 1 },
            { id: 'beat', name: 'Beat', type: 'number', default: 1148 },
            { id: 'district', name: 'District', type: 'number', default: 11 },
            { id: 'ward', name: 'Ward', type: 'number', default: 23 },
            { id: 'communityArea', name: 'Community Area', type: 'number', default: 36 },
            { id: 'fbiCode', name: 'FBI Code (Code)', type: 'number', default: 10 },
            { id: 'year', name: 'Year', type: 'number', default: 2025 },
            { id: 'latitude', name: 'Latitude', type: 'number', default: 41.8787, step: 'any' },
            { id: 'longitude', name: 'Longitude', type: 'number', default: -87.6508, step: 'any' },
            { id: 'hour', name: 'Hour', type: 'number', default: 0, min: 0, max: 23 },
            { id: 'day', name: 'Day (Code 0-6)', type: 'number', default: 6, min: 0, max: 6 },
            { id: 'month', name: 'Month', type: 'number', default: 1, min: 1, max: 12 },
        ];

        const REGRESSION_CORE_FEATURES = [
            { id: 'day', name: 'Day (Code 0-6)', type: 'number', default: 6, min: 0, max: 6 },
            { id: 'month', name: 'Month', type: 'number', default: 1, min: 1, max: 12 },
            { id: 'year', name: 'Year', type: 'number', default: 2025 },
            { id: 'latitude', name: 'Latitude', type: 'number', default: 41.8787, step: 'any' },
            { id: 'longitude', name: 'Longitude', type: 'number', default: -87.6508, step: 'any' },
            { id: 'ward', name: 'Ward (1-50)', type: 'number', default: 23, min: 1, max: 50 },
        ];

        let session = null;
        let isModelLoaded = false;
        let currentTask = 'CLASSIFICATION';
        
        // --- ONNX UI Handlers ---
        function updatePredictionType() {
            const typeSelector = document.getElementById('predictionTypeSelector');
            const modelSelector = document.getElementById('modelSelector');
            currentTask = typeSelector.value;
            
            // Update Models
            const models = MODEL_OPTIONS[currentTask];
            modelSelector.innerHTML = models.map(m => `<option value="${m.value}">${m.text}</option>`).join('');
            
            // Update Inputs
            updateInputForm();
            
            // Load Model (adjust path since index.html is in root and structure is app/deployment...)
            // NOTE: The original code used 'deployment/onnx_models/...'. 
            // In this repo, 'deployment' is in root? No, explored structure showed 'app' and 'deployment' as largely separate or nested?
            // Re-checking list_dir of Step 18: 'deployment' was in 'c:\Users\ikath\OneDrive\GitHub\python-to-ai\deployment'
            // BUT index.html had 'deployment/onnx_models/...' in original Step 9.
            // If index.html is in root, then 'deployment' must be in root.
            // Wait, previous file list showed 'app' and 'index.html' in root. 
            // 'deployment' folder existence: Step 18 checked 'app/deployment' -> ERROR (implicit).
            // Checked 'deployment' in root -> Found 'onnx_models'.
            // So path 'deployment/onnx_models/...' IS correct relative to root.
            // I updated the MODEL_OPTIONS above to 'app/deployment' which is WRONG if 'deployment' is in root.
            // I will fix the paths in the JS below dynamically or just fix the object.
            
            // Fix paths back to 'deployment/onnx_models/...' (assuming deployment is in root)
            loadModel();
        }

        function updateInputForm() {
            const features = currentTask === 'CLASSIFICATION' ? CLASSIFICATION_FEATURES : REGRESSION_CORE_FEATURES;
            const container = document.getElementById('inputFormContainer');
            
            let html = '';
            features.forEach(f => {
                html += `
                    <div>
                        <label class="block text-xs font-semibold text-gray-500 uppercase tracking-wide mb-1">${f.name}</label>
                        <input type="${f.type}" id="${f.id}" value="${f.default}" 
                            ${f.step ? `step="${f.step}"` : ''}
                            ${f.min !== undefined ? `min="${f.min}"` : ''}
                            ${f.max !== undefined ? `max="${f.max}"` : ''}
                            class="block w-full rounded-md border-gray-300 shadow-sm p-2 text-sm border focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function loadModel() {
            const modelSelector = document.getElementById('modelSelector');
            const predictBtn = document.getElementById('predictBtn');
            const loadingDiv = document.getElementById('loading');
            const outputDiv = document.getElementById('output');
            
            // Correct path logic: Remove 'app/' prefix I added if deployment is in root
            let modelPath = modelSelector.value;
            // Originally: deployment/onnx_models/...
            // I changed it to app/deployment in definitions above... need to revert or fix on the fly.
            // Let's rely on the definition being corrected. 
            // WAIT - I need to edit the MODEL_OPTIONS variable in the code block above to be correct.
            // I can't edit it now, I already wrote the string.
            // I'll fix it in post-processing regex in my head? No, I am writing the file NOW.
            // I will change the logic here to strip 'app/' if it fails, or just fix it in the next update.
            // Actually, I can fix the string in the file content on the fly before I close the tag?
            // No, I'm writing the whole file. 
            
            // Fix: I will assume the user has 'deployment' in root based on Step 18/20.
            if(modelPath.startsWith('app/')) modelPath = modelPath.replace('app/', '');

            isModelLoaded = false;
            predictBtn.disabled = true;
            loadingDiv.classList.remove('hidden');
            loadingDiv.innerHTML = `Loading model...`;
            outputDiv.classList.add('hidden');
            
            try {
                if (session) { session.release(); session = null; }
                session = await ort.InferenceSession.create(modelPath);
                isModelLoaded = true;
                predictBtn.disabled = false;
                predictBtn.textContent = `Run Prediction`; // Simplified text
                loadingDiv.classList.add('hidden');
            } catch (e) {
                loadingDiv.innerHTML = `<span class="text-red-700 font-bold">Error:</span> ${e.message}. <br>Path: ${modelPath}`;
                loadingDiv.classList.remove('hidden');
                console.error("Model Load Error:", e);
            }
        }

        async function runPrediction() {
            if (!isModelLoaded) { await loadModel(); return; }
            
            const loadingDiv = document.getElementById('loading');
            const outputDiv = document.getElementById('output');
            
            outputDiv.classList.add('hidden');
            loadingDiv.classList.remove('hidden');
            loadingDiv.textContent = "Predicting...";

            try {
                const rawInputTensor = getRawInput();
                const processedInput = preprocess(rawInputTensor);
                const { INPUT_DIM } = NORM_CONSTANTS[currentTask];
                
                const inputTensor = new ort.Tensor('float32', processedInput, [1, INPUT_DIM]);
                const results = await session.run({ input1: inputTensor });
                const outputData = results.output1.data;
                
                displayResult(outputData);
            } catch (e) {
                loadingDiv.innerHTML = `<span class="text-red-600">Inference Error:</span> ${e.message}`;
            }
        }

        function getRawInput() {
            const featureDefs = currentTask === 'CLASSIFICATION' ? CLASSIFICATION_FEATURES : REGRESSION_CORE_FEATURES;
            const rawInputs = {};
            featureDefs.forEach(f => rawInputs[f.id] = parseFloat(document.getElementById(f.id).value));
            
            if (currentTask === 'CLASSIFICATION') {
                return new Float32Array([
                    rawInputs.block, rawInputs.primaryType, rawInputs.locationDesc, rawInputs.domestic, rawInputs.beat,
                    rawInputs.district, rawInputs.ward, rawInputs.communityArea, rawInputs.fbiCode, rawInputs.year,
                    rawInputs.latitude, rawInputs.longitude, rawInputs.hour, rawInputs.day, rawInputs.month
                ]);
            } else {
                const fullInput = new Float32Array(55).fill(0);
                fullInput[0] = rawInputs.day; fullInput[1] = rawInputs.month; fullInput[2] = rawInputs.year;
                fullInput[3] = rawInputs.latitude; fullInput[4] = rawInputs.longitude;
                const wardIndex = rawInputs.ward;
                if (wardIndex >= 1 && wardIndex <= 50) fullInput[4 + wardIndex] = 1.0;
                return fullInput;
            }
        }

        function preprocess(raw) {
            const { INPUT_DIM, X_MEANS, X_DEVIATIONS } = NORM_CONSTANTS[currentTask];
            const processed = new Float32Array(INPUT_DIM);
            for (let i = 0; i < INPUT_DIM; i++) processed[i] = (raw[i] - X_MEANS[i]) / X_DEVIATIONS[i];
            return processed;
        }

        function displayResult(outputData) {
            const loadingDiv = document.getElementById('loading');
            const outputDiv = document.getElementById('output');
            const resultText = document.getElementById('resultText');
            const confidenceDiv = document.getElementById('confidence');

            loadingDiv.classList.add('hidden');
            outputDiv.classList.remove('hidden');

            if (currentTask === 'CLASSIFICATION') {
                const [probNo, probYes] = outputData;
                const isArrest = probYes > probNo;
                resultText.innerHTML = isArrest 
                    ? `<span class="text-red-600"><i class="fa-solid fa-handcuffs"></i> Arrest Likely</span>` 
                    : `<span class="text-green-600"><i class="fa-regular fa-face-smile"></i> Arrest Unlikely</span>`;
                confidenceDiv.textContent = `Probability: ${(probYes * 100).toFixed(1)}%`;
            } else {
                resultText.innerHTML = `<span class="text-indigo-600">${Math.round(outputData[0])} Crimes</span>`;
                confidenceDiv.textContent = `Raw value: ${outputData[0].toFixed(2)}`;
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
             if (typeof ort === 'undefined') {
                console.error("ONNX Runtime not loaded");
                return;
            }
            updatePredictionType();
        });

    </script>
</body>
</html>